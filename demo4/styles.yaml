camera:
    type: perspective
    vanishing_point: [-.25, -.75]

lighting:
    type: directional

layers:
    cycleway:
        filter: function () { return feature.highway == "cycleway"; }
        color:
            default: [.8, 0, 0.8]
        width:
            default: Style.pixels(5)

    bridges:
        filter: function () { return feature.is_bridge == "yes"; }
        color:
            default: [0, 0.8, 0.8]
        width:
            default: Style.pixels(10)

    roads:
        properties:
            width: 2
        color:
            default: [1, 1, 1]
        width:
            default: function () { return properties.width; }

    buildings:
        mode:
            name: buildings
        properties:
            min_height: 5
        filter: function () { return feature.height > properties.min_height; }
        extrude:
            default: true

    earth:
        color:
            default: [.5, .5, .5]

    landuse:
        color:
            default: [.6, .6, .6]

    water:
        color:
            default: [.4, .4, .4]

modes:
    buildings:
        extends: polygons
        shaders:
            uniforms:
                u_height: 0
                u_color_height: 0
            transforms:
                globals: |
                    uniform float u_height;
                    uniform float u_color_height;
                vertex: |
                    position.z *= u_height * .01;
                fragment: |
                    if (v_world_position.z > u_color_height) color = lighting * vec3(.8);
                    else color = lighting * vec3(.5);
